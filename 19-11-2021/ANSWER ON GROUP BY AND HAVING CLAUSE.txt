QUESTIONS ON GROUP BY AND HAVING CLAUSE
1. WRITE A QUERY TO DISPLAY TOTAL SALARY NEEDED TO PAY EACH JOB IN EMPLOYEE TABLE.
SELECT SUM(SALARY) ,JOB_TITLE FROM EMPLOYEES group by JOB_TITLE;

2. WRITE A QUERY TO DISPLAY THE HIRE DATE ON WHICH AT LEAST 3 EMPLOYEES WHERE HIRED.
SELECT HIREDATE FROM EMPLOYEES group by HIREDATE HAVING COUNT(*)>=3;

3. WRITE A QUERY TO DISPLAY THE DEPARTMENT NUMBER WHICH HAS MORE THAN 2 EMPLOYEES AND THE TOTAL
 AMOUNT REQUIRED TO PAY THE MONTHLY SALARIES OF ALL THE EMPLOYEES IN THAT DEPARTMENT SHOULD BE MORE
 THAN 9000.
SELECT OFFICE_ID FROM EMPLOYEES group by OFFICE_ID HAVING COUNT(*)>=2 AND SUM(SALARY)>9000;

4. WRITE A QUERY TO DISPLAY NUMBER OF EMPLOYEES WORKING IN EACH DEPARTMENT AND ITS’ AVERAGE SALARY
 BY EXCLUDING ALL THE EMPLOYEES WHOSE SALARY IS LESS THAN THEIR COMMISSION.


5. WRITE A QUERY TO DISPLAY THE SALARIES WHICH HAS REPETITIONS IN THE SAL COLUMN OF EMPLOYEE TABLE.
SELECT SALARY FROM EMPLOYEES group by SALARY;

6. WRITE A QUERY TO DISPLAY THE EMPLOYEE NAME ONLY IF MORE THAN ONE PERSON IN THE EMPLOYEES OF THE
 COMPANY HAS SAME NAME.
SELECT FIRST_NAME FROM EMPLOYEES group by FIRST_NAME HAVING COUNT(*)>1;

7. WRITE A QUERY TO DISPLAY THE DEPARTMENT NUMBER WHOSE AVERAGE SALARY IS BETWEEN 2500 AND 3000.
SELECT OFFICE_ID FROM EMPLOYEES group by OFFICE_ID HAVING avg(SALARY);

8. WRITE A QUERY TO DISPLAY THE NUMBER OF EMPLOYEES ONLY IF THEY ARE WORKING AS MANAGER OR ANALYST 
AND THEIR ANNUAL SAL SHOULD END WITH A ZERO, IN EACH DEPARTMENT.
SELECT count(*) FROM EMPLOYEES WHERE JOB_TITLE IN('MANAGER','ANALYSIT')
AND SALARY*12 ='%0'

GROUP BY OFFICE_ID;

9. WRITE A QUERY TO DISPLAY NO OF CLERKS WORKING IN EACH DEPARTMENT.
SELECT count(*) FROM EMPLOYEES WHERE JOB_TITLE IN('Social Worker')
GROUP BY OFFICE_ID;

10. WRITE A QUERY TO DISPLAY HIGHEST SALARY GIVEN TO A MANAGER IN EACH DEPARTMENT.
SELECT max(salary) FROM EMPLOYEES
GROUP BY OFFICE_ID;

11. WRITE A QUERY TO DISPLAY NO OF TIMES THE SALARIES HAVE REPEATED IN THE EMP TABLE.
SELECT count(salary) FROM EMPLOYEES
GROUP BY salary;

12.WRITE A QUERY TO DISPLAY DEPTNO AND MUNBER OF EMPLOYEES WHORKING IN EACH DEPARTMENT EXCEPT 
FOR THOSE WORKING IN DEPT 10
SELECT OFFICE_ID,count(office_ID) FROM EMPLOYEES
WHERE OFFICE_ID NOT IN(10)
GROUP BY  OFFICE_ID;

13.WAQTD NUMBER OF EMPLOYEES GETTING COMISSION IN EACH DEPARTMENT
SELECT COUNT(*) FROM EMP WHERE COMM>0 GROUP BY DEPTNO;


14.WAQTD NUMBER OF EMPLOYEES GETTING SALARY MORE THAN 1600 EXCLUDING ALL THE MANAGERS IN EACH
 DEPARTEMNT
SELECT COUNT(*) FROM EMP WHERE SAL>1600 AND DESIGNATION NOT IN ('MANAGER') GROUP BY DEPTNO;


15.WAQTD AVERAGE SALARY NEEDED TO PAY ALL THE EMPLOYEES WHO ARE HAVING A REPORTING MANAGER IN EACH
 JOB .
SELECT avg(SAL) FROM EMP WHERE MGR IS NULL GROUP BY DESIGNATION;


16.WAQTD NUMBER OF EMPLOYEES HIRED INTO THE SAME DEPARTMENT ON THE SAME DAY
SELECT COUNT(*) FROM EMP  GROUP BY HIREDATE HAVING COUNT(*)>1;

17.WAQTD NUMBER OF EMPLOYEES GETTING THE SAME SALARY , WORKING IN THE SAME DEPARTMENT
SELECT COUNT(*) FROM EMP  GROUP BY DEPTNO HAVING COUNT(*)>1;


18.WAQTD MAXIMUM SALARY GIVEN IN EACH DESIGNATION EXCLUDING THOSE WHOS NAME STARTS WITH ‘K’
SELECT MAX(SAL) FROM EMP WHERE FNAME NOT LIKE 'K%' GROUP BY DESIGNATION ;


19.WAQTD NUMBER OF EMPLOYEES REPORTING TO 7839 IN EACH DEPT
SELECT COUNT(*)FROM EMP WHERE MGR=37270 GROUP BY DEPTNO ;


20.WAQTD NUMBER OF EMPLOYEE NAMES STARTING WITH AN VOWEL IN EACH DEPARTMENT
SELECT COUNT(*)FROM EMP WHERE FNAME IN ('A','E','I','O','U') GROUP BY DEPTNO ;

